<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Furniture Visualizer with Three.js</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: system-ui, -apple-system, sans-serif; background: #f5f5f5; }
        .container { display: flex; height: 100vh; }
        #canvas { flex: 1; }
        .controls { width: 320px; background: white; padding: 20px; overflow-y: auto; border-left: 1px solid #ddd; }
        .header { margin-bottom: 20px; }
        .header h1 { font-size: 20px; margin-bottom: 5px; }
        .header p { font-size: 12px; color: #666; }
        .control-group { margin-bottom: 16px; }
        .control-group label { display: block; font-weight: 600; font-size: 13px; margin-bottom: 5px; }
        .control-group input, .control-group select { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px; }
        .value-display { font-size: 11px; color: #999; margin-top: 3px; }
        button { width: 100%; padding: 10px; margin-bottom: 8px; border: none; border-radius: 4px; font-weight: 600; cursor: pointer; font-size: 13px; }
        .btn-primary { background: #2196F3; color: white; }
        .btn-primary:hover { background: #1976D2; }
        .btn-secondary { background: #888; color: white; }
        .btn-secondary:hover { background: #666; }
    </style>
</head>
<body>
    <div class="container">
        <canvas id="canvas"></canvas>
        <div class="controls">
            <div class="header">
                <h1>üìê 3D Furniture</h1>
                <p>Interactive 3D Model</p>
            </div>
            <div class="control-group">
                <label>Width (mm)</label>
                <input type="number" id="width" value="2226" min="1000" max="4000" step="50">
                <div class="value-display" id="widthVal">2226 mm</div>
            </div>
            <div class="control-group">
                <label>Height (mm)</label>
                <input type="number" id="height" value="1620" min="800" max="2500" step="50">
                <div class="value-display" id="heightVal">1620 mm</div>
            </div>
            <div class="control-group">
                <label>Depth (mm)</label>
                <input type="number" id="depth" value="530" min="300" max="1000" step="10">
                <div class="value-display" id="depthVal">530 mm</div>
            </div>
            <div class="control-group">
                <label>Material</label>
                <select id="material">
                    <option value="#ffffff">White MDF</option>
                    <option value="#d0d0d0">Gray MDF</option>
                    <option value="#8b6f47">Oak</option>
                    <option value="#2a2a2a">Black</option>
                </select>
            </div>
            <button class="btn-primary" onclick="downloadScreenshot()">üì• Screenshot</button>
            <button class="btn-secondary" onclick="resetCamera()">üîÑ Reset View</button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        const canvas = document.getElementById('canvas');
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0xf5f5f5);
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 10000);
        camera.position.set(300, 250, 400);
        camera.lookAt(0, 0, 0);
        const renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
        renderer.setSize(window.innerWidth - 320, window.innerHeight);
        renderer.shadowMap.enabled = true;
        
        let furniture = null;
        
        function createFurniture(w, h, d, color) {
            if (furniture) scene.remove(furniture);
            furniture = new THREE.Group();
            const sw = w / 100;
            const sh = h / 100;
            const sd = d / 100;
            
            const bodyGeometry = new THREE.BoxGeometry(sw, sh, sd);
            const bodyMaterial = new THREE.MeshPhongMaterial({ color, shininess: 30 });
            const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
            body.castShadow = true;
            body.receiveShadow = true;
            furniture.add(body);
            
            const panelGeometry = new THREE.BoxGeometry(sw - 4, sh - 10, 2);
            const panelMaterial = new THREE.MeshPhongMaterial({ color: 0x2196F3, shininess: 60 });
            const panel = new THREE.Mesh(panelGeometry, panelMaterial);
            panel.position.z = sd / 2 + 1;
            panel.castShadow = true;
            furniture.add(panel);
            
            for (let i = 1; i <= 2; i++) {
                const shelfGeometry = new THREE.BoxGeometry(sw - 2, 1, sd - 2);
                const shelfMaterial = new THREE.MeshPhongMaterial({ color: 0xeeeeee });
                const shelf = new THREE.Mesh(shelfGeometry, shelfMaterial);
                shelf.position.y = -sh / 3 + (i * sh / 5);
                shelf.castShadow = true;
                shelf.receiveShadow = true;
                furniture.add(shelf);
            }
            
            scene.add(furniture);
        }
        
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
        scene.add(ambientLight);
        
        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
        directionalLight.position.set(300, 300, 300);
        directionalLight.castShadow = true;
        directionalLight.shadow.mapSize.width = 2048;
        directionalLight.shadow.mapSize.height = 2048;
        scene.add(directionalLight);
        
        const groundGeometry = new THREE.PlaneGeometry(1000, 1000);
        const groundMaterial = new THREE.MeshPhongMaterial({ color: 0xcccccc });
        const ground = new THREE.Mesh(groundGeometry, groundMaterial);
        ground.rotation.x = -Math.PI / 2;
        ground.position.y = -100;
        ground.receiveShadow = true;
        scene.add(ground);
        
        let isDragging = false;
        let previousMousePosition = { x: 0, y: 0 };
        let rotation = { x: 0, y: 0 };
        
        canvas.addEventListener('mousedown', function(e) {
            isDragging = true;
            previousMousePosition = { x: e.clientX, y: e.clientY };
        });
        
        canvas.addEventListener('mousemove', function(e) {
            if (!isDragging || !furniture) return;
            const deltaX = e.clientX - previousMousePosition.x;
            const deltaY = e.clientY - previousMousePosition.y;
            rotation.y += deltaX * 0.005;
            rotation.x += deltaY * 0.005;
            furniture.rotation.y = rotation.y;
            furniture.rotation.x = rotation.x;
            previousMousePosition = { x: e.clientX, y: e.clientY };
        });
        
        canvas.addEventListener('mouseup', function() {
            isDragging = false;
        });
        
        canvas.addEventListener('mouseleave', function() {
            isDragging = false;
        });
        
        canvas.addEventListener('wheel', function(e) {
            e.preventDefault();
            camera.position.z += e.deltaY * 0.3;
            camera.position.z = Math.max(50, Math.min(1000, camera.position.z));
        });
        
        document.getElementById('width').addEventListener('input', function(e) {
            document.getElementById('widthVal').textContent = e.target.value + ' mm';
            updateFurniture();
        });
        
        document.getElementById('height').addEventListener('input', function(e) {
            document.getElementById('heightVal').textContent = e.target.value + ' mm';
            updateFurniture();
        });
        
        document.getElementById('depth').addEventListener('input', function(e) {
            document.getElementById('depthVal').textContent = e.target.value + ' mm';
            updateFurniture();
        });
        
        document.getElementById('material').addEventListener('change', updateFurniture);
        
        function updateFurniture() {
            const w = parseFloat(document.getElementById('width').value);
            const h = parseFloat(document.getElementById('height').value);
            const d = parseFloat(document.getElementById('depth').value);
            const color = document.getElementById('material').value;
            createFurniture(w, h, d, color);
        }
        
        function resetCamera() {
            camera.position.set(300, 250, 400);
            if (furniture) {
                furniture.rotation.set(0, 0, 0);
                rotation = { x: 0, y: 0 };
            }
        }
        
        function downloadScreenshot() {
            renderer.render(scene, camera);
            canvas.toBlob(function(blob) {
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'furniture_3d.png';
                link.click();
                URL.revokeObjectURL(url);
            });
        }
        
        window.addEventListener('resize', function() {
            const width = window.innerWidth - 320;
            const height = window.innerHeight;
            camera.aspect = width / height;
            camera.updateProjectionMatrix();
            renderer.setSize(width, height);
        });
        
        function animate() {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        }
        
        updateFurniture();
        animate();
    </script>
</body>
</html>
